#!/usr/bin/env nodejs
var ev = require('bindings')('equihashverify.node');

//Expect False
header = Buffer('0400000008e9694cc2120ec1b5733cc12687b609058eec4f7046a521ad1d1e3049b400003e7420ed6f40659de0305ef9b7ec037f4380ed9848bc1c015691c90aa16ff3930000000000000000000000000000000000000000000000000000000000000000c9310d5874e0001f000000000000000000000000000000010b000000000000000000000000000040', 'hex');
soln = Buffer('00b43863a213bfe79f00337f5a729f09710abcc07035ef8ac34372abddecf2f82715f7223f075af96f0604fc124d6151fc8fb516d24a137faec123a89aa9a433f8a25a6bcfc554c28be556f6c878f96539186fab191505f278df48bf1ad2240e5bb39f372a143de1dd1b672312e00d52a3dd83f471b0239a7e8b30d4b9153027df87c8cd0b64de76749539fea376b4f39d08cf3d5e821495e52fdfa6f8085e59fc670656121c9d7c01388c8b4b4585aa7b9ac3f7ae796f9eb1fadba1730a1860eed797feabb18832b5e8f003c0adaf0788d1016e7a8969144018ecc86140aa4553962aa739a4850b509b505e158c5f9e2d5376374652e9e6d81b19fa0351be229af136efbce681463cc53d7880c1eeca3411154474ff8a7b2bac034a2026646776a517bf63921c31fbbd6be7c3ff42aab28230bfe81d33800b892b262f3579b7a41925a59f5cc1d4f523577c19ff9f92023146fa26486595bd89a1ba459eb0b5cec0578c3a071dbec73eca054c723ab30ce8e69de32e779cd2f1030e39878ac6ea3cdca743b43aedefe1a9b4f2da861038e2759defef0b8cad11d4179f2f08881b53ccc203e558c0571e049d998a257b3279016aad0d7999b609f6331a0d0f88e286a70432ca7f50a5bb8fafbbe9230b4ccb1fa57361c163d6b9f84579d61f41585a022d07dc8e55a8de4d8f87641dae777819458a2bf1bb02c438480ff11621ca8442ec2946875cce247c8877051359e9c822670d37bb00fa806e60e8e890ce62540fda2d5b1c790ca1e005030ac6d8e63db577bb98be111ee146828f9c48ee6257d7627b93ea3dd11aac3412e63dfc7ca132a73c4f51e7650f3f8ecf57bfc18716990b492d50e0a3e5fbf6136e771b91f7283ec3326209265b9531d157f8a07a4117fc8fb29ba1363afc6f9f0608251ea595256727a5bbe28f42a42edfbfa9017680e32980d4ad381612612b2bc7ad91e82eca693ea4fc27049a99636b50a576f1e55c72202d582b150ef194c1419f53177ecf315ea6b0e2f1aa8cd8f59b165aa0d89561c537fb6141f5813b7a4968fe16afc703326113f68508d88ff8d0aee1e88a84c0ae56c72f27511290ced48e93e8c95419d14aed1a5b2e9b2c9c1070c593e5eb50bb9a80e14e9f9fe501f56b1b3140159e8213b75d48d14af472a604484cd8e7e7abb6820245ed3ab29f9947463a033c586194be45eadec8392c8614d83a1e9ca0fe5655fa14f7a9c1d1f8f2185a06193ff4a3c3e9a96b02310033ceaa25894e7c56a6147e691597098054e285d39656d3d459ec5d13243c062b6eb44e19a13bdfc0b3c96bd3d1aeb75bb6b080322aea23555993cb529243958bb1a0e5d5027e6c78155437242d1d13c1d6e442a0e3783147a08bbfc0c2529fb705ad27713df40486fd58f001977f25dfd3c202451c07010a3880bca63959ca61f10ed3871f1152166fce2b52135718a8ceb239a0664a31c62defaad70be4b920dce70549c10d9138fbbad7f291c5b73fa21c3889929b143bc1576b72f70667ac11052b686891085290d871db528b5cfdc10a6d563925227609f10d1768a0e02dc7471ad424f94f737d4e7eb0fb167f1434fc4ae2d49e152f06f0845b6db0a44f0d6f5e7410420e6bd1f430b1af956005bf72b51405a04d9a5d9906ceca52c22c855785c3c3ac4c3e9bf532d31bab321e1db66f6a9f7dc9c017f2b7d8dfeb933cf5bbae71311ae318f6d187ebc5c843be342b08a9a0ff7c4b9c4b0f4fa74b13296afe84b6481440d58332e07b3d051ed55219d28e77af6612134da4431b797c63ef55bc53831e2f421db620fee51ba0967e4ed7009ef90af2204259bbfbb54537fd35c2132fa8e7f9c84bf9938d248862c6ca1cca9f48b0b33aa1589185c4eabc1c32', 'hex');

console.log(ev.verify(header, soln));

//Expect True
header = Buffer('b738f7e9eec8cbbe9aa7f59aacc4a397446f936a19384cefc72cc7da3f0845330000000000000000000000000000000000000000f75e061e0b38511e576ef4ad05f22992b1a4c88a7d1adb8d14ca4193c2afb15945b0cfc220ceec5b7c1c62c4d4193d38e4eba48e8815729ce75f9c0ab0e4c1c045b0cfc220ceec5b7c1c62c4d4193d38e4eba48e8815729ce75f9c0ab0e4c1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000005a049bc600000000000000123078666666666162636400000000000000000000000000000000000000000000000000000000000000000000004c4b400a806dd03b1d61568ce11f4217c5c2f0d1136eb661637048c473f31b6ad9ea14', 'hex');
soln = Buffer('013d2c61a453b8198b8ca1bbebcf9011b1f679f503050eb5665befc98f8628a1d6707f1394e1be34ca30057926336586a7c464bc15ddea606c763815ba3e304f4162b96c2053b971fa3895526e16ceed67592e5c18b3fa99ae4fdccfe58142ba063f038ec52b1a368029ee26696cced245478604b1f3c30f8b180e5e0ca522018717eca95b6fc85d9250cdceb452664adf997236062a923116a92d0c6239076bfe730e75aa58e4c5050a3e6f7e0417669216b10f78b515f07f3a7819d6292431b2339dcdb52e49d3ed16ba4cb9275a5b7496173adf0e130d61cd86e2929051adc88ce166f38e46188cc0fd42e40a8b7114320f77fad7c55d18ee0df70e2e22b9dcc4742957606264ec3c6374c0168c51b824640cba7e5be971b14f72666b253668a9cfc735b64b1c9b23d01d9f2effe9b534a0d0c8f9688d1f86224bea7a84f05b41e18fa5a7b6905647ce9128f7893503a6c12ca08a8b2daf7933bbfa5e273ef1dbdb5b442a2e1719b256b6b97de3b6e3d9dea2a281643b7c9d13857338c313853b0673122ea9cc67a50919d960092dfd91f3aa2a434fa64183c4e1486d49435cbf3a270a9229ada3a61b3f6f9380b9aecc791074b2b86de717cceadcf2d911f33f0db4bd89519b4d53ff5f390515cc3e3d0de5c0136a6fa57f2dffba65a545db50ad1d78f16b9d5a93ed9576633bf3f5a999f15a5c653403a8de7316837ad8c2160a836bf0f13acc45b74a0d2282eddd364d4971da4cc2bcb7c11189aaabdda02e163f5fd42acce64ee637e229d9d14b3d58d6f4d31e1f894ea789ac7f3d99b1a9612fece052e161b71f420ce8a97e0f842e1a346fd85a0efe0f729dbf78c7d21b3aca70afea3b6daa9f2517aab44c31d1c1f122931ce5c398fa8c082a7aa43205b03f02ed0e5c1f96dd39c9d5907fe00e279d13249597eb67118246dea4a301693475b5346643ab41d173d71af6691e74ab53691cfab55c59687945a87cb911304c9636d2471afd282a6c7a6eaa136c24ef137b51e771c0f73e5c7f9f2442047257b5d3792911d077af7c5a840a376952827812b8758fd106fcd9521f44fac3cd66bdfa441094571308ba0ba72b29ada5dea3d1315018064d863ccca6249323b6e30fd61df5f2553d8ebeca2eb8129ccf5a25a7417f8d54ac85b0cc234d1a37eb4ce792313da3035437c176b3ae07f381b0f70d081aa330169e15851738dd12da8fff6cb766060964fcd19312bfdef82209930073c79f0ddd35f352040c2c9d35306391dc7427e69a25443df5c1f6f6c7c35c5d2732a09159f5e80772af991498ba0fa7e882f50cc4a90372e53d535518e9f72e0d20dd63713771cc6ba9f25f48309f681f0bafc613d81ab6e1854070ddcb9d6a249fcc5077f910948b1d4c85da6ce3509234abf16b81055d6efe7c04adae846a52995362738399e0482a0d1726f58fef5be79fbd01e4213f81a8089f454fe20a7241da20f11270b9725c65ce7f553f83a12ccae496cd6f9c928123d439e0c40c5947f9e7e27388df4bb909735922f207b871ab8fcae341239241cc10d6da7593557a19b5096010a92b82b14ee2d2b158e3fc60c5832c5dea8813eedefa5b04fe4467a561ed9842ed863bcf5d714539de069c6b5e42779528b4ab7af85a05bef2946c7c07ff4141fd59ddb7a88cb4231ea2a9851ddebf55c019a68f778c601bcf90c1a29dc15d11e314f43e32f50b5e82ac5a47b7a0eac1f3facb5d908e756d9c2b0620b5b1647fcb0058c45e17ed6777bc1721a51be5b41b3979b6099465ff24aea1df8273c188d342eaa461380ef7c308362fc1d57d57817cc9fb7a11f5d501f02d631275375435e3a103979f31beea729046bf704b2dc4c23a36181f4efb4943c7a1529c1a0563931646', 'hex');

console.log(ev.verify(header, soln));

//Expect True
header = Buffer('8b33ed709571ab5df98cb3b0db5e509274e35c7030051ddc5da7fca9626798350000000000000000000000000000000000000000fe1b8ad7e3b18d994c7397935a9e3897dc91559966e77690571e4ecb6878f7bd45b0cfc220ceec5b7c1c62c4d4193d38e4eba48e8815729ce75f9c0ab0e4c1c045b0cfc220ceec5b7c1c62c4d4193d38e4eba48e8815729ce75f9c0ab0e4c1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000005a049caa00000000000000153078666666666162636400000000000000000000000000000000000000000000000000000000000000000000004c4b4040e8e3adcf07ef9ebac6d53e96afb859b506120c0c45638d45cc4f772faf9161', 'hex');
soln = Buffer('00bee567690d0e9deecf74d2a9e4c332fad6fde73e238ed57563d4eb7fc926837352777a6d497feb3ed605aa5617ea0a2327e2b5e1305528760856445a446a0c2685e49cdbbe68eec0b19c9f2d6af964159c0ed9195ae2f249dde9ad37e7a1c4b4ecd4d881a22fb17f263b962370de9fabc96d33793f6157e543f32cf8681a059144f1106b4968f8c5527663b87e3c9adde55d4020bdd4979f1c2fcb0c055d7444fdf9d66e54526c039617d1e3093f02c509a1133f7e9e909a47f6b491336a2e5d0fd3798fb813c49ac9ba344ddbdc3d4b775b053590019cc8b51fc2d6ed196f6cb62de43a3a59759265091163f5299b19a81310f6940e22f25b75850e0dfa08d4a03a39d5d63290c3d91524b3e638b8d011af257668ed417d7c83d33078b15e51278d333b22140beb6eb5996c0ff0f2f221ac927b2e29e47264971fa4550120e6c6338f3db63317d541f99f3fdb673c01332ae7c44e0474c6b730b12e5920551f6bd6357634c5a601bdafe68d851115a3b1cab215e40e14925f13387afb5c491051d1adc4e625dc17d1940852ac3f79aa96ed6ee76715833e084aaae4ae9e73a798359404a022b8170c70da715094062033fdc95c273bb0d92449d42d1b94616b32ec730579db99192799add2042682ee6814a694e7655323446d547899571f136c287083c4baf22e056fa7a2580b4273f80a139c7c989e07e8711d1158550729d95570e247d582fb19bc245b29e77e7b5e58286367f9a559f363330b6e9d3d7b801218936514064afd5aa0117ae3e438ef2ecc9a69c12774b67ea6a4f43feee2631f24edb8c1bc5ab1425b09d0c71e89d28d473b3ed163dd5ef1e8e6dcd84a1b1569e7b2dec927c6da26377a51663c324e355a27300f644924569f7c314d64a3086821a3559c81192fad16d4cc389490b77353d1458488cb624e02567fe93c01c1f976ecef03439a4869f095f2a5428a425a7aed57b69407f81ae0cf3719b68d78b5b002fdc91ad8fc1a263eda161e4ce529ef66c9c4da77bdfc635883af363357b4a99ea01dd05ff3f1b4cbcc5d87509de80107c6e2e1c8f46b77fec9285ac179cf7e51b15479e81cd436239a6ed42bc968822487413c9de3bf536abe0c28f4aa200926664aa0f5428dad02cde384b9c7391f6837a3350b0ecccf5cd8737557698eff52d959ed02d9a49ef5de20999d4530fec80a926fbfb49f073907f98e0ed6da8337ad48b1e02ff92f31d7901600d21b6b84f85cc96aa7079fc60bd2717adb2e285d658a2d2989a5c5debf71816347d15bf98bf2819e5f26821215bf41b787c05716d7b151297962db48e11e5306199a5b197d5d196b684df680e4b5824784bb9cc09025602e1bf30980d167dea4d95c500a01bbce34c1ce26b432ca838d1c8b9fb8162105d978d64ad8f6cfd002a7f4bf2a5dc3c994f29519436f1e3257851c374006f53c821bccce78aeb9ab2b255fe7cf3e31fcd4180ea642669c45956a34cbd7d7cd75a45345fddc8279516fd379571ccfe8f4f04552d84081cf06b8b8645a0c24d17df7707d11f4841141367ea7007b2f3f24712d503a66e85e8c79a66d87be0cca160e3e4dde90c931f614d0e750516bcafa43f72239835d70acade4cc508a0e4dbe795df3d8fcb58bd06428c597f65223cc07bdb260751443cca978a7d89b67842b3c27fb1bc1126361c953062f73d4125701703d4c5a1c54f5f8c80f784d1384dfd0d3146c28858adbe8fe3ba6de34f2155779ad424986fd6ff1216869a839261a22fa3dab0d49e7207715b895ace9183d7df744eeb099f926a4105a738775136694a1ab64ab07348cf5ffc1fcb85026dffda49a19f5b3ecef22890ec818fd6f5f3b70802c1885d7b62b4ea9ae9803119332e5bd6ac715ae76', 'hex');

console.log(ev.verify(header, soln));
